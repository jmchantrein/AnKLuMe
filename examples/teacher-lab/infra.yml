---
# infra.yml â€” Primary Source of Truth (PSOT)
#
# Teacher lab: anklume domain + 3 student domains.
# Each student gets an isolated network with a web server and a client.
# Scale by copying the student domain blocks.
#
# IPs: anklume -> 10.100.0.x (admin)
#       students -> 10.120.x.x (semi-trusted, auto-sequenced)

project_name: networking-lab

global:
  addressing:
    base_octet: 10
    zone_base: 100
  default_os_image: "images:debian/13"
  default_connection: community.general.incus
  default_user: root

domains:
  anklume:
    trust_level: admin
    description: "Teacher administration"
    machines:
      lab-admin:
        description: "Ansible controller for the lab"
        type: lxc
        config:
          security.nesting: "true"
        roles:
          - base_system

  student-01:
    trust_level: semi-trusted
    description: "Student 1 lab environment"
    ephemeral: true
    machines:
      s01-web:
        description: "Student 1 web server"
        type: lxc
        roles:
          - base_system
      s01-client:
        description: "Student 1 client"
        type: lxc
        roles:
          - base_system

  student-02:
    trust_level: semi-trusted
    description: "Student 2 lab environment"
    ephemeral: true
    machines:
      s02-web:
        description: "Student 2 web server"
        type: lxc
        roles:
          - base_system
      s02-client:
        description: "Student 2 client"
        type: lxc
        roles:
          - base_system

  student-03:
    trust_level: semi-trusted
    description: "Student 3 lab environment"
    ephemeral: true
    machines:
      s03-web:
        description: "Student 3 web server"
        type: lxc
        roles:
          - base_system
      s03-client:
        description: "Student 3 client"
        type: lxc
        roles:
          - base_system
