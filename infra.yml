---
# infra.yml — Primary Source of Truth (PSOT)
#
# Describes your infrastructure at a high level. After editing, run:
#   make sync        # Generate/update Ansible files
#   make apply       # Apply to Incus
#
# See docs/SPEC.md section 5 for the full format reference.

project_name: my-infra

global:
  base_subnet: "192.168"
  default_os_image: "images:debian/13"
  default_connection: community.general.incus
  default_user: root

domains:
  admin:
    description: "Administration and orchestration"
    subnet_id: 0
    machines:
      admin-ansible:
        description: "Ansible controller — drives the whole infra"
        type: lxc
        ip: "192.168.0.10"
        config:
          security.nesting: "true"
        roles:
          - base_system

  work:
    description: "Professional environment"
    subnet_id: 1
    machines:
      dev-workspace:
        description: "Main development workspace"
        type: lxc
        ip: "192.168.1.10"
        config:
          limits.cpu: "4"
          limits.memory: "8GiB"
        roles:
          - base_system
