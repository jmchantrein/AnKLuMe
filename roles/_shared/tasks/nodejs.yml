---
# Shared task: Install Node.js repository via NodeSource
#
# Required variable: _nodejs_version (e.g., "22")
# Usage: ansible.builtin.include_tasks: roles/_shared/tasks/nodejs.yml
#        vars:
#          _nodejs_version: "{{ my_role_node_version }}"

- name: Install Node.js repository  # noqa: command-instead-of-module risky-shell-pipe
  ansible.builtin.shell:
    cmd: "curl -fsSL https://deb.nodesource.com/setup_{{ _nodejs_version }}.x | bash -"
    creates: /etc/apt/sources.list.d/nodesource.list
  changed_when: true

- name: Install Node.js
  ansible.builtin.apt:
    name: nodejs
    state: present
    update_cache: true
